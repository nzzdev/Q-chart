{
  "$schema": "https://vega.github.io/schema/vega/v3.0.json",
  "height": 450,
  "signals": [
    {
      "name": "const___compactBarWidth",
      "value": 28
    },
    {
      "name": "const___maxBarWidth",
      "value": 44
    },
    {
      "name": "const___maxBarGroupWidth",
      "value": 220
    },
    {
      "name": "columnMargin",
      "value": 1
    },
    {
      "name": "groupMargin",
      "update": "const___compactBarWidth / 2"
    },
    {
      "name": "numberOfColumns",
      "value": null
    },
    {
      "name": "groupMarginTotal",
      "update": "(groupMargin * numberOfColumns) / (numberOfColumns > 1 ? numberOfColumns - 1 : 1)"
    }
  ],
  "data": [
    {
      "name": "table",
      "values": []
    }
  ],
  "scales": [
    {
      "name": "xScale",
      "type": "band",
      "range": "width",
      "domain": {
        "data": "table",
        "field": "xValue"
      },
      "padding": 0
    },
    {
      "name": "yScale",
      "type": "linear",
      "range": "height",
      "domain": {
        "data": "table",
        "field": "yValue"
      },
      "nice": true,
      "zero": true
    },
    {
      "name": "colorScale",
      "type": "ordinal",
      "range": "category",
      "domain": {
        "data": "table",
        "field": "cValue"
      }
    }
  ],
  "marks": [
    {
      "type": "group",
      "name": "wrapper-group",
      "encode": {
        "update": {
          "width": {
            "signal": "width"
          },
          "height": {
            "signal": "height"
          }
        }
      },
      "marks": [
        {
          "type": "group",
          "from": {
            "facet": {
              "name": "series",
              "data": "table",
              "groupby": "xValue"
            }
          },
          "encode": {
            "update": {
              "x": {
                "scale": "xScale",
                "field": "xValue"
              }
            }
          },
          "signals": [
            {
              "name": "columnWidth",
              "update": "min((bandwidth('xScale') - groupMargin) / numberOfColumns, const___maxBarGroupWidth / numberOfColumns, const___maxBarWidth)"
            },
            {
              "name": "width",
              "update": "(columnWidth + columnMargin) * numberOfColumns + groupMargin - groupMarginTotal"
            },
            {
              "name": "marginLeft",
              "update": "(bandwidth('xScale') - width) / 2"
            }
          ],
          "scales": [
            {
              "name": "barPositionScale",
              "type": "band",
              "range": "width",
              "paddingInner": 0,
              "paddingOuter": 0,
              "domain": {
                "data": "series",
                "field": "yValue"
              }
            }
          ],
          "marks": [
            {
              "type": "rect",
              "name": "bar",
              "from": {
                "data": "series"
              },
              "encode": {
                "update": {
                  "x": {
                    "signal": "marginLeft + scale('barPositionScale', datum.yValue)"
                  },
                  "y": {
                    "scale": "yScale",
                    "field": "yValue"
                  },
                  "y2": {
                    "scale": "yScale",
                    "value": 0
                  },
                  "width": {
                    "signal": "bandwidth('barPositionScale') - columnMargin"
                  },
                  "fill": {
                    "scale": "colorScale",
                    "signal": "datum.cValue"
                  }
                }
              }
            }
          ]
        }
      ],
      "axes": [
        {
          "orient": "bottom",
          "scale": "xScale",
          "grid": false,
          "domain": true,
          "ticks": false,
          "offset": 0
        },
        {
          "orient": "left",
          "scale": "yScale",
          "domain": false,
          "grid": true
        }
      ]
    }
  ],
  "autosize": {
    "type": "fit",
    "contains": "padding"
  },
  "config": {
    "axis": {
      "bandPosition": 0,
      "padding": 0.4,
      "zero": true,
      "grid": true,
      "gridColor": "#e9e9ee",
      "labels": true,
      "labelAngle": 0,
      "labelBound": false,
      "labelFlush": false,
      "labelFlushOffset": false,
      "ticks": true
    }
  }
}